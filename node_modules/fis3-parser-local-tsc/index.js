var shelljs = require("shelljs");

var root;


module.exports = function (content, file, conf) {
    // 只对 js 类文件进行处理
    if (!file.isJsLike) return content;
    root = root || fis.project.getProjectPath();
    //shelljs.cd(root);//TODO?

    console.dir(file);

    //{ origin: '/Users/lvsheng/work/personal/vm/src/Parser.ts',
    //    rest: '/Users/lvsheng/work/personal/vm/src/Parser',
    //    hash: '',
    //    query: '',
    //    fullname: '/Users/lvsheng/work/personal/vm/src/Parser.ts',
    //    dirname: '/Users/lvsheng/work/personal/vm/src',
    //    ext: '.ts',
    //    filename: 'Parser',
    //    basename: 'Parser.ts',
    //    realpath: '/Users/lvsheng/work/personal/vm/src/Parser.ts',
    //    realpathNoExt: '/Users/lvsheng/work/personal/vm/src/Parser',
    //    subpath: '/src/Parser.ts',
    //    subdirname: '/src',
    //    subpathNoExt: '/src/Parser',
    //    rExt: '.js',
    //    useCompile: true,
    //    useDomain: true,
    //    useCache: true,
    //    useHash: false,
    //    useMap: true,
    //    domain: '',
    //    requires: [],
    //    links: [],
    //    asyncs: [],
    //    derived: [],
    //    extras: {},
    //    _isImage: false,
    //        _isText: true,
    //    _likes: { isHtmlLike: false, isJsLike: true, isCssLike: false },
    //    charset: 'utf8',
    //        __parserFIndex: 1,
    //    __parserIndex: 1,
    //    parser:
    //    { hello: 'conf',
    //        __plugin: 'local-tsc',
    //        __name: 'local-tsc',
    //        __pos: undefined },
    //    __rExtFIndex: 1,
    //        __rExtIndex: 1,
    //    __releaseFIndex: 2,
    //    __releaseIndex: 2,
    //    release: '/o2o/vm/src/Parser.js',
    //    __urlFIndex: 2,
    //    __urlIndex: 2,
    //    url: '/~lvsheng/o2o/vm//src/Parser.js',
    //    id: 'src/Parser.ts',
    //    moduleId: 'src/Parser',
    //    _content:
    //    {},//removed, too long
    //    _start: 1440640310049,
    //        _fromCache: false,
    //    cache:
    //    { timestamp: 1440640306000,
    //        deps: {},
    //        version: '3.0.13',
    //            cacheFile: '/Users/lvsheng/.fis3-tmp/cache/compile/release-dev/Parser.ts-c-1173a7efbc.tmp',
    //        cacheInfo: '/Users/lvsheng/.fis3-tmp/cache/compile/release-dev/Parser.ts-o-1173a7efbc.json' }
    //}

    //console.log(file.pathname);

    return content += '\n// build ' + Date.now()
};
